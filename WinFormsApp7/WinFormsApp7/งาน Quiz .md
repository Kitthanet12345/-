namespace WinFormsApp7
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }

        private void txtName_Click(object sender, EventArgs e)
        {

        }

        private void txtStudentID_TextChanged(object sender, EventArgs e)
        {
            using System;
            using System.Collections.Generic;

// ???? Student (????????)
class Student
        {
            public string StudentID { get; set; }
            public string Name { get; set; }
            public string Major { get; set; }
            public Advisor Advisor { get; set; }  // ????????????????

            public Student(string studentID, string name, string major)
            {
                StudentID = studentID;
                Name = name;
                Major = major;
                Advisor = null;  // ???????????????????????????????????????
            }

            public void SetAdvisor(Advisor advisor)
            {
                Advisor = advisor;
            }

            public override string ToString()
            {
                return $"{StudentID}: {Name}, {Major}";
            }
        }

        // ???? Advisor (????????????????)
        class Advisor
        {
            public string Name { get; set; }
            public string Major { get; set; }
            public List<Student> Students { get; private set; }  // ????????????????????????

            public Advisor(string name, string major)
            {
                Name = name;
                Major = major;
                Students = new List<Student>();
            }

            public void AddStudent(Student student)
            {
                if (student.Advisor == null) // ?????????????????????????????????????
                {
                    student.SetAdvisor(this);
                    Students.Add(student);
                }
                else
                {
                    Console.WriteLine($"???????????????????????????????????: {student.Name}");
                }
            }

            public void ShowStudents()
            {
                Console.WriteLine($"?????????????????? {Name} ??????????????:");
                foreach (var student in Students)
                {
                    Console.WriteLine($"- {student.Name} ({student.StudentID})");
                }
            }

            public Student GetTopStudent()
            {
                // ???????????????????? StudentID ???????????????
                return Students.Count > 0 ? Students[0] : null;  // ?????????????????????
            }
        }

        // ???? StudentManagement (???????????????)
        class StudentManagement
        {
            private List<Student> students = new List<Student>();
            private List<Advisor> advisors = new List<Advisor>();

            public void AddStudent(Student student)
            {
                students.Add(student);
            }

            public void AddAdvisor(Advisor advisor)
            {
                advisors.Add(advisor);
            }

            public void ShowAllStudents()
            {
                Console.WriteLine("??????????????????????:");
                foreach (var student in students)
                {
                    Console.WriteLine(student);
                }
            }

            public void ShowAdvisorStudents(string advisorName)
            {
                foreach (var advisor in advisors)
                {
                    if (advisor.Name == advisorName)
                    {
                        advisor.ShowStudents();
                        return;
                    }
                }
                Console.WriteLine($"????????????????????????? {advisorName}");
            }

            public void ShowTopStudent()
            {
                Student topStudent = null;
                foreach (var student in students)
                {
                    // ????????????????? StudentID ???????????????
                    if (topStudent == null || int.Parse(student.StudentID.Substring(1)) > int.Parse(topStudent.StudentID.Substring(1)))
                    {
                        topStudent = student;
                    }
                }
                if (topStudent != null)
                {
                    Console.WriteLine($"????????????????????????: {topStudent.Name}, ?????: {topStudent.StudentID}");
                }
                else
                {
                    Console.WriteLine("????????????????????????????????");
                }
            }
        }

        // ???????????
        class Program
        {
            static void Main(string[] args)
            {
                // ???????????????????????
                Student student1 = new Student("S001", "?????", "???????????????????");
                Student student2 = new Student("S002", "??????", "???????????????????");

                Advisor advisor1 = new Advisor("???????????????", "???????????????????");

                // ?????????????????????????????
                StudentManagement management = new StudentManagement();

                // ???????????????????????
                management.AddAdvisor(advisor1);
                management.AddStudent(student1);
                management.AddStudent(student2);

                // ??????????????????????????????????????
                advisor1.AddStudent(student1);
                advisor1.AddStudent(student2);

                // ??????????????????????????
                management.ShowAllStudents();

                // ???????????????????????????????????????
                management.ShowAdvisorStudents("???????????????");

                // ????????????????????????????
                management.ShowTopStudent();
            }
        }

    }
}
}
